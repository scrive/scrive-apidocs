###
adminsmain=
<strong>Stats CSVs</strong>
<p><a href="/adminonly/allstatscsv">Download the CSV containing  all signature stats</a></p>
<p><a href="/adminonly/userstatscsv">Download the CSV containing all user stats</a></p>
    <strong>Sales Tools</strong>
    <table><tbody>
        <tr>
          <td style="height:50px;width:200px">
            <a href="/adminonly/useradminforsales">
              <button style="width:150px"> Sales user admin</button>
            </a>
          </td>
          <td style="height:50px;width:200px">
            <a href="/adminonly/companyadmin">
              <button style="width:150px"> Company Admin </button>
            </a>
          </td>
       </tr>
   </tbody></table>
    <br/>
    <br/>
    <strong>Admin Tools</strong>
    <table><tbody>
        <tr>
          <td style="height:50px;width:200px">
            <a href="/adminonly/statistics">
              <button style="width:150px"> Statistics</button>
            </a>
          </td>
          <td style="height:50px">
            <a href="/adminonly/payments">
              <button style="width:150px">Price Plan</button>
            </a>
          </td>
        </tr>
        <tr>
          <td style="height:50px;">
            <a href="/adminonly/functionalitystats">
              <button style="width:150px">Functionality Stats</button>
            </a>
          </td>
          <td style="height:50px">
            <a href="/adminonly/documents">
              <button style="width:150px">Documents</button>
            </a>
          </td>
        </tr>
        <tr>
          <td style="height:50px;width:200px"> <a href="/adminonly/useradmin"><button style="width:150px"> User Admin </button> </a></td>
        </tr>
    </tbody></table>
    <br/>
    <br/>
    <strong> Super Admin Tools Only </strong>
    <table><tbody>
        <tr>
          <td style="height:50px;width:200px"> <a href="/adminonly/advpayments"><button style="width:150px"> App Admin </button> </a></td>
          <td style="height:50px;width:200px"><a href="/adminonly/services"><button style="width:150px"> Services </button> </a> </td>
        </tr>
        <tr>
        </tr>
    </tbody></table>
    <br/>
    <br/>
    <strong> Log Files </strong>
    <ul>
      <li><a href="/adminonly/log/debug.log">debug.log</a></li>
      <li><a href="/adminonly/log/mail.log">mail.log</a></li>
      <li><a href="/adminonly/log/error.log">error.log</a></li>
    </ul>
#####
adminusers=
   <div id="tab-viewer">
         <div class="tab-header">
          <strong>
           <span>USER ADMIN</span>
           <span style="margin-left:20px">  $backtoadminmainlink()$</span>
          </strong>
          </div>
       <div id="adminusers-viewer"></div>
    </div>
    <script>
    var adminUsersTable = KontraList().init({
        name : "Admin Users Table",
        schema: new Schema({
            url: "/adminonly/userslist",
            sorting: new Sorting({ 
                fields: [
                      "username"
                    , "email" 
                    , "company"
                    , "uploaded_docs"
                    , "signed_docs"
                    , "signed_1m"
                    , "signed_2m"
                    , "signed_3m"
                    , "signed_6m"
                    , "signed_12m"
                    ]}),
            paging: new Paging({}),
            filtering: new Filtering({text: "", infotext: "Username, email or company name."}),
            cells : [
                new Cell({name: "Username"     , width:"100px", field:"username", special:"link"}),
                new Cell({name: "Email"        , width:"140px", field:"email", special:"link"}),
                new Cell({name: "Company"      , width:"120px", field:"company", special:"link"}),
                new Cell({name: "Uploaded Docs", width:"50px",  field:"uploaded_docs", special:"link"}),
                new Cell({name: "Signed (tot)" , width:"40px",  field:"signed_docs", special:"link"}),
                new Cell({name: "Signed (1m)"  , width:"40px",  field:"signed_1m", special:"link"}),
                new Cell({name: "Signed (2m)"  , width:"40px",  field:"signed_2m", special:"link"}),
                new Cell({name: "Signed (3m)"  , width:"40px",  field:"signed_3m", special:"link"}),
                new Cell({name: "Signed (6m)"  , width:"40px",  field:"signed_6m", special:"link"}),
                new Cell({name: "Signed (12m)" , width:"40px",  field:"signed_12m", special:"link"}),
                new Cell({name: "Viral Invites", width:"40px",  field:"viral_invites", special:"bool"}),
                new Cell({name: "Admin Invites", width:"40px",  field:"admin_invites", special:"bool"})
                ]
        })
    });

    jQuery(function(){
        jQuery("#adminusers-viewer").append(adminUsersTable.view.el)
    });
    </script>

###
admincompanies=
   <div id="tab-viewer">
         <div class="tab-header">
          <strong>
           <span>COMPANY ADMIN</span>
           <span style="margin-left:20px">  $backtoadminmainlink()$</span>
          </strong>
          </div>
       <div id="companies-viewer"></div>
    </div>
<script>
  var companiesTable = KontraList().init({
    name : "CompaniesTable",
    schema: new Schema({
      url: "/adminonly/companies",
      sorting: new Sorting({ fields: [
                                       "companyname",
                                       "companynumber",
                                       "companyaddress",
                                       "companyzip",
                                       "companycity",
                                       "companycountry"  ] }),
      paging: new Paging({}),
      filtering: new Filtering({ text: "", infotext: "Search companies" }),
      cells : [
        new Cell({name: "Name",   width:"120px", field:"companyname"   , special:"link"}),
        new Cell({name: "Number", width:"100px", field:"companynumber" , special:"link"}),
        new Cell({name: "Address",width:"200px", field:"companyaddress", special:"link"}),
        new Cell({name: "Zip",    width:"50px",  field:"companyzip"    , special:"link"}),
        new Cell({name: "City",   width:"100px", field:"companycity"   , special:"link"}),
        new Cell({name: "Contry", width:"100px", field:"companycountry", special:"link"}),
        new Cell({name: "ID",     width:"120px", field:"id"            , special:"link"})
      ]
    })
  });

  jQuery(function(){
    jQuery("#companies-viewer").append(companiesTable.view.el);
  });
</script>
###
adminUsersForSales=
   <div class='create-user'>
    <table> 
     <tbody>
      <tr>
      <td style="width: 300px">
         <h1> Create user -----></h1> <BR/>
         If someone will make me I'll do it nicer. Mariusz
      </td>
      <td>
        <form method="post" action="/createuser">
        <table style="width:500px">
          <tr>
            <td>First name:</td>
            <td><input type="text" name="fstname"/></td>
          </tr>
          <tr>
            <td>Second name:</td>
            <td><input type="text" name="sndname"/></td>
          </tr>
          <tr>
            <td>Email address:</td>
            <td><input type="email" name="email"/></td>
          </tr>
          <tr>
            <td>Region:</td>
            <td><select name="region">
              <option $if(user.regiongb)$selected=""$endif$ value="REGION_SE">Sweden (Swedish)</option>
              <option $if(user.regionse)$selected=""$endif$ value="REGION_GB">Britain (English)</option>
                </select>
            </td>
          </tr>
         <tr>
            <td>Header:</td>
            <td> <input type="button" class="editer" value="Default"/>
                 <span class="editable" name="custommessage" style="display:none">$mailNewAccountCreatedByAdminContentHeader()$</span>

           </td>
          </tr>
        </table><br/>
        <input type="submit" value="Create user" />
      </form>
    </td>
    </tr>
   </tbody>
   </table>
   </div>
   <div id="tab-viewer">
         <div class="tab-header">
          <strong>
           <span>USER ADMIN FOR SALES</span>
           <span style="margin-left:20px">  $backtoadminmainlink()$</span>
          </strong>
          </div>
       <div id="users-viewer"></div>
    </div>
    <script>
    var usersTable = KontraList().init({
        name : "Users Table",
        schema: new Schema({
            url: "/adminonly/userslist",
            sorting: new Sorting({ fields: ["username", "email", "company", "phone", "tos", "signed_docs"]}),
            paging: new Paging({}),
            filtering: new Filtering({text: "", infotext: "Username, email or company name."}),
            cells : [
                new Cell({name: "Username", width:"130px", field:"username", special:"link"}),
                new Cell({name: "Email", width:"130px", field:"email", special:"link"}),
                new Cell({name: "Company", width:"100px", field:"company", special:"link"}),
                new Cell({name: "Phone", width:"100px", field:"phone", special:"link"}),
                new Cell({name: "TOS date", width:"100px", field:"tos", special:"link"}),
                new Cell({name: "Signed Docs", width:"100px", field:"signed_docs", special:"link"}),
                new Cell({name: "Subaccounts", width:"100px", field:"subaccounts", special:"link"})
                ]
        })
    });

    jQuery(function(){
        jQuery("#users-viewer").append(usersTable.view.el)
    });
    </script>
###
adminuser=
    <a href="$adminlink$">Go back to main admin page</a>
    <a style="padding-left:100px" href="$adminuserslink$">Go back to user admin page</a>
    <br/>
    <br/>
    <form action="" method="POST">
      <div id="tab-viewer">
	<div class="tab-header">
	</div>
	<ul class="tabs">
	  <li class="active"><a href="$adminuserslink$/$user.id$">Anv√§ndaruppgifter</a></li>
	  <li><a href="#">Payment info</a></li>
	  <li><a href="#">Payment list</a></li>
	  <li><a href="$adminuserslink$/usagestats/$user.id$">Statistics</a></li>
	</ul>
	<div class="tab-container">
	  <div class="tab-content account">
	    <table><tbody>
		<tr> <th style="width:200px"></th> <th> </th></tr>
		<tr> <td style="padding-top:10px"><strong>User data</strong></td> <td> </td></tr>
		<tr> <td>First Name:</td>
		  <td>
		    <input type="text" style="width:200px;margin:0" value="$user.fstname$"  name="userfstname" />
		  </td>
		</tr>
		<tr> <td>Secound Name:</td>
		  <td>
		    <input type="text" style="width:200px;margin:0" value="$user.sndname$"  name="usersndname" />
		  </td>
		</tr>
		<tr> <td>Pers Nr:</td>
		  <td>
		    <input type="text" style="width:200px;margin:0" value="$user.personalnumber$"  name="userpersonalnumber" />
		  </td>
		</tr>
		<tr> <td style="padding-top:10px" ><strong>Contact</strong></td>
		  <td>
		  </td>
		</tr>
		<tr> <td>Phone:</td>
		  <td>
		    <input type="text" style="width:200px;margin:0"  value="$user.phone$" name="userphone" />
		  </td>
		</tr>
		<tr> <td>Mobile:</td>
		  <td>
		    <input type="text" style="width:200px;margin:0" value="$user.mobile$" name="usermobile" />
		  </td>
		</tr>
		<tr> <td>Email:</td>
		  <td>
		    <input type="text" style="width:200px;margin:0"  value="$user.email$" name="useremail" />
		  </td>
		</tr>
		<tr> <td>Company position:</td>
		  <td>
		    <input type="text" style="width:200px;margin:0" value="$user.companyposition$"  name="usercompanyposition" />
		  </td>
		</tr>
    <tr> <td>Region:</td>
      <td><select name="userregion">
        <option $if(user.regionse)$selected=""$endif$ value="REGION_SE">Sweden (Swedish)</option>
        <option $if(user.regiongb)$selected=""$endif$ value="REGION_GB">Britain (English)</option>
      </select></td>
    </tr>
		<tr>
		  <td style="padding-top:10px" ><strong>Account</strong></td>
		  <td> </td>
		</tr>
		<tr> <td>Account type:</td>
		  <td>
		    $if(user.iscompanyaccount)$
        <p><a href="/adminonly/companyadmin/$company.companyid$">
         view company $company.companyname$
        </a></p>
        $endif$

		    <select name="useraccounttype">
		      <option $if(user.iscompanyaccount)$$if(user.iscompanyadmin)$selected=""$endif$$endif$ value="companyadminaccount">$company.companyname$ Admin Company Account $if(!user.iscompanyaccount)$(Creates a new company)$endif$</option>
		      <option $if(user.iscompanyaccount)$$if(!user.iscompanyadmin)$selected=""$endif$$endif$ value="companystandardaccount">$company.companyname$ Standard Company Account $if(!user.iscompanyaccount)$(Creates a new company)$endif$</option>
		      <option $if(!user.iscompanyaccount)$selected=""$endif$value="privateaccount">Private Account $if(user.iscompanyaccount)$(May leave an empty company)$endif$</option>
		    </select>
		  </td>
		</tr>
	    </tbody></table>
	    <br/>
	    <input type="submit" style="width:200px;font-weight:bold"
	    value="Change" name="change" />
	  </div>
	</div>
      </div>
    </form>
####
admincompany=
    <a href="$adminlink$">Go back to main admin page</a>
    <a style="padding-left:100px" href="$admincompanieslink$">Go back to company admin page</a>
    <br/>
    <br/>
    <form action="" method="POST">
      <div id="tab-viewer">
	<div class="tab-header">
	</div>
	<ul class="tabs">
	  <li class="active"><a href="$admincompanieslink$/$companyid$">Company Information</a></li>
	  <li><a href="$admincompanieslink$/users/$companyid$">Users</a></li>
	  <li><a href="$admincompanieslink$/usagestats/$companyid$">Statistics</a></li>
	</ul>
	<div class="tab-container">
	  <div class="tab-content account">
	    <table><tbody>
		<tr> <th style="width:200px"></th> <th> </th></tr>
		<tr> <td style="padding-top:10px"><strong>Company data</strong></td> <td> </td></tr>
		<tr> <td>Name:</td>
		  <td>
		    <input type="text" style="width:200px;margin:0" value="$companyname$"  name="companyname" />
		  </td>
		</tr>
		<tr> <td>Company nr:</td>
		  <td>
		    <input type="text" style="width:200px;margin:0" value="$companynumber$"  name="companynumber" />
		  </td>
		</tr>
		<tr> <td style="padding-top:10px"><strong>Company Location</strong></td>
		  <td> </td>
		</tr>
		<tr> <td>Adress:</td>
		  <td> <input type="text" style="width:200px;margin:0" value="$companyaddress$"  name="companyaddress" />
		  </td>
		</tr>
		<tr> <td>ZIP:</td>
		  <td>
		    <input type="text" style="width:200px;margin:0" value="$companyzip$"  name="companyzip" />
		  </td>
		</tr>
		<tr> <td>City:</td>
		  <td>
		    <input type="text" style="width:200px;margin:0" value="$companycity$"  name="companycity" />
		  </td>
		</tr>
		<tr> <td>Country:</td>
		  <td>
		    <input type="text" style="width:200px;margin:0" value="$companycountry$" name="companycountry" />
		  </td>
		</tr>
	    </tbody></table>
	    <br/>
	    <input type="submit" style="width:200px;font-weight:bold"
	    value="Change" name="change" />
	  </div>
	</div>
      </div>
    </form>
####
admincompanyusers=
<a href="$adminlink$">Go back to main admin page</a>
<a style="padding-left:100px" href="$admincompanieslink$">Go back to company admin page</a>
<br/>
<br/>
<div id="tab-viewer">
  <div class="tab-header">
  </div>
  <ul class="tabs">
    <li><a href="$admincompanieslink$/$companyid$">Company Information</a></li>
    <li class="active"><a href="$admincompanieslink$/users/$companyid$">Users</a></li>
    <li><a href="$admincompanieslink$/usagestats/$companyid$">Statistics</a></li>
  </ul>
  <div class="tab-container">
    <div class="tab-content account">
      <div style="height:195px;border: 1px solid gray;padding:10px;">
        <div class="float-left">
          <form method="post" action="$admincompanieslink$/users/$companyid$">
            <h2>Create user:</h2>
            <table style="width:450px">
              <tr>
                <td>First name:</td>
                <td><input type="text" name="fstname"/></td>
              </tr>
              <tr>
                <td>Second name:</td>
                <td><input type="text" name="sndname"/></td>
              </tr>
              <tr>
                <td>Email address:</td>
                <td><input type="email" name="email"/></td>
              </tr>
              <tr>
                <td>Is Admin?</td>
                <td>
                  <input type="checkbox" name="iscompanyadmin"/>
                </td>
              </tr>
              <tr>
                <td>Region:</td>
                <td>
                  <select name="region">
                    <option $if(user.regiongb)$selected=""$endif$ value="REGION_SE">Sweden (Swedish)</option>
                    <option $if(user.regionse)$selected=""$endif$ value="REGION_GB">Britain (English)</option>
                  </select>
                </td>
              </tr>
              <tr>
                <td>Header:</td>
                <td>
                  <input type="button" class="editer " value="Default"/>
                  <span class="editable" name="custommessage" style="display:none">$mailNewAccountCreatedByAdminContentHeader()$</span>
                </td>
              </tr>
            </table><br/>
            <input type="submit" value="Add User" />
          </form>
        </div>
        <div class="float-left">
          <form method="post" action="$admincompanieslink$/users/$companyid$">
            <h2>Invite private user:</h2>
            <input type="hidden" name="privateinvite" value="true" />
            <table>
              <tr>
                <td style="width:173px;">Email address:</td>
                <td><input type="email" name="email"/></td>
              </tr>
            </table><br/>
            <input type="submit" value="Invite Private User" />
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  jQuery(function() {

    var companyAccountsTable = KontraList().init({
      name : "CompanyAccountsTable",
      schema: new Schema({
        url: "/adminonly/companyaccounts/$companyid$",
        sorting: new Sorting({ fields: ["fullname",
                                        "email",
                                        "role",
                                        "activated",
                                        "id",
                                        "deletable"] }),
        paging: new Paging({}),
        filtering: new Filtering({ text: "", infotext: "Company Accounts" }),
        cells: [
          new Cell({name: "Name", width: "100px", field:"fullname"}),
          new Cell({name: "Email", width: "100px", field:"email"}),
          new Cell({name: "Role", width: "100px", field:"role", special: "rendered",
                    rendering: function(value, idx, user) {
                      if (user.field("role")=="RoleAdmin") {
                        return jQuery("<span>Admin</span>");
                      } else if (user.field("role")=="RoleStandard") {
                        return jQuery("<span>Standard</span>");
                      } else {
                        return jQuery("<span>Pending</span>");
                      }
                    }})
        ]
      })
    });
    jQuery(".tab-content").append(companyAccountsTable.view.el);
  });
</script>
####
userusagestats=
   <a href="$adminlink$">Go back to main admin page</a>
    <a style="padding-left:100px" href="$adminuserslink$">Go back to user admin page</a>
    <br/>
    <br/>
    <div id="tab-viewer">
      <div class="tab-header">
      </div>
      <ul class="tabs">
	<li><a href="$adminuserslink$/$user.id$">Anv√§ndaruppgifter</a></li>
	<li><a href="#">Payment info</a></li>
	<li><a href="#">Payment list</a></li>
	<li class="active"><a href="$adminuserslink$/usagestats/$user.id$">Statistics</a></li>
      </ul>
      <div class="tab-container">
	<div class="tab-content account">
	  <table>
            <thead>
              <td style="width:200px">Date</td>
              <td style="width:200px">Documents Closed That Day</td>
              <td style="width:200px">Total Closed Signatures That Day</td>
              <td style="width:200px">Average Signatures / Doc</td>
              <td style="width:200px">Documents Sent That Day</td>
	    </thead>
            $statistics:{stat|<tr>
              <td>$stat.date$</td>
              <td>$stat.closed$ </td>
              <td>$stat.signatures$ </td>
              <td>$stat.avg$ </td>
              <td>$stat.sent$ </td>
	    </tr>}$
	  </table>
	</div>
      </div>
    </div>
####
companyusagestats=
    <a href="$adminlink$">Go back to main admin page</a>
    <a style="padding-left:100px" href="$admincompanieslink$">Go back to company admin page</a>
    <br/>
    <br/>
      <div id="tab-viewer">
	<div class="tab-header">
	</div>
	<ul class="tabs">
	  <li><a href="$admincompanieslink$/$companyid$">Company Information</a></li>
	  <li><a href="$admincompanieslink$/users/$companyid$">Users</a></li>
	  <li class="active"><a href="$admincompanieslink$/usagestats/$companyid$">Statistics</a></li>
	</ul>
      <div class="tab-container">
	<div class="tab-content account">
	  <table>
            <thead>
              <td style="width:200px">Date</td>
              <td style="width:200px">User</td>
              <td style="width:200px">Documents Closed</td>
              <td style="width:200px">Total Closed Signatures</td>
              <td style="width:200px">Average Signatures / Doc</td>
              <td style="width:200px">Documents Sent</td>
	    </thead>
            $statistics:{stat|<tr class="$if(stat.istotal)$totalline$endif$">
              <td>$stat.date$</td>
              <td>$stat.user$</td>
              <td>$stat.closed$ </td>
              <td>$stat.signatures$ </td>
              <td>$stat.avg$ </td>
              <td>$stat.sent$ </td>
	    </tr>}$
	  </table>
	</div>
      </div>
    </div>
###
statisticsPage=
    $backtoadminmainlink()$
    <div>
      <h1>Stats this month by date</h1>
	  <table>
            <thead>
              <td style="width:200px">Date</td>
              <td style="width:200px">Documents Closed</td>
              <td style="width:200px">Total Closed Signatures</td>
              <td style="width:200px">Average Signatures / Doc</td>
              <td style="width:200px">Documents Sent</td>
              <td style="width:200px">New Users (TOS)</td>
	    </thead>
            $statisticsbyday:{stat|<tr>
              <td>$stat.date$</td>
              <td>$stat.closed$ </td>
              <td>$stat.signatures$ </td>
              <td>$stat.avg$ </td>
              <td>$stat.sent$ </td>
              <td>$stat.users$ </td>
	    </tr>}$
	  </table>
      <h1>Stats by month</h1>
	  <table>
            <thead>
              <td style="width:200px">Month</td>
              <td style="width:200px">Documents Closed</td>
              <td style="width:200px">Total Closed Signatures</td>
              <td style="width:200px">Average Signatures / Doc</td>
              <td style="width:200px">Documents Sent</td>
              <td style="width:200px">New Users (TOS)</td>
	    </thead>
            $statisticsbymonth:{stat|<tr>
              <td>$stat.date$</td>
              <td>$stat.closed$ </td>
              <td>$stat.signatures$ </td>
              <td>$stat.avg$ </td>
              <td>$stat.sent$ </td>
              <td>$stat.users$ </td>
	    </tr>}$
	  </table>
    </div>
###
###
adminFunctionalityStatsPage=
    $backtoadminmainlink()$
    <div>
      <h1>Functionality Statistics</h1><br/><br/>
      <p>The purpose of these stats is to indicate how much functionality is being used.  Deleted documents or users are not counted here.</p><br/><br/>
      <p>A recent user is one that accepted the TOS within the last 90 days.  A recent document is one created within the last 90 days.</p><br/><br/>
	    <table>
        <thead>
          <th style="width:400px;text-align:right;padding-right:20px;"></th>
          <th style="width:200px;text-align:left;">Recent User Count</th>
	      </thead>
        $userfunctionalitystats:{stat|
        <tr>
          <th style="text-align:right;padding-right:20px;">$stat.label$</th>
          <td>$stat.count$ </td>
	      </tr>
	      }$
	    </table><br/><br/>
	    <table>
        <thead>
          <th style="width:400px;text-align:right;padding-right:20px;"></th>
          <th style="width:200px;text-align:left;">Recent Document Count</th>
	      </thead>
        $docfunctionalitystats:{stat|
        <tr>
          <th style="text-align:right;padding-right:20px;">$stat.label$</th>
          <td>$stat.count$ </td>
	      </tr>
	      }$
	    </table><br/><br/>
	    <table>
	    </table>
    </div>
###
backtoadminmainlink=
   <a href="$adminlink$">Go back to main admin page</a>
    <br/><br/>
####
servicesAdmin=
$backtoadminmainlink()$
<div>
<h4 style="margin-left:200px">All services </h4>
<BR/>
<table style="text-align:left">
<thead>
  <tr>
      <th style="width: 200px;"> Name</th>
      <th style="width: 300px;"> Users </th>
      <th style="width: 300px;"> Location </th>
  </tr>
</thead>
<tbody>
$services:{service |<tr>
    <td>$service.name$ </td>
    <td>$service.admin$ </td>
    <td>$service.location$ </td>
</tr>}$
</tbody>
</table>
</div>
<BR/>
<BR/>
<BR/>
<form method="POST">
<h4 style="margin-left:200px">Create service </h4>
<BR/>
<table><tbody>
<tr> <td style="width:200px;">Name: </td><td><input type="text" name="name"/> </td></tr>
<tr> <td>Admin: </td><td><input type="text" name="admin"/></td></tr>
<tr> <td>Password: </td><td><input type="password" name="password"/> </td></tr>
<tr> <td>Location: </td><td><input type="text" name="location"/> </td></tr>
</tbody></table>
<input type="submit" name="create" value="Create"/>
</form>
<BR/>
<BR/>
###
admindocumentslist =

   <div id="tab-viewer">
         <div class="tab-header">
          <strong>
           <span>DOCUMENTS</span>
           <span style="margin-left:20px">  $backtoadminmainlink()$</span>
          </strong>
          </div>
         <div id="documents-viewer"></div>
    <script>
    var docTable = KontraList().init({
        name : "Documents Table",
        schema: new Schema({
            url: "/adminonly/documentslist",
            sorting: new Sorting({ 
                fields: [
                      "ctime"
                    , "mtime"
                    , "id"
                    , "author"
                    , "title"
                    , "service"
                    , "status"
                    , "type"
                    , "signs"
                    ]}),
            paging: new Paging({}),
            filtering: new Filtering({infotext: "Filter documents"}),
            cells : [
                new Cell({name: "Dates", width:"80px", field: "mtime", special: "rendered",
                        rendering: function(_, _, doc) {
                               return jQuery("<small><span>"
                                          + doc.field("ctime") + " <BR/> " 
                                          + doc.field("mtime") +
                                       " </small>");
                          }}),
                new Cell({name: "Author", width:"120px", field:"author", special: "rendered",
                        rendering: function(value, idx, doc) {
                            if (value != undefined) 
                                return jQuery("<small><span>" + value.name    + " <BR/> " 
                                                   + value.email   + " <BR/> " 
                                                   + value.company + "</span></small>");
                          }}),
                new Cell({name: "Title", width:"120px", field:"title",  special: "rendered", 
                        rendering: function(value, idx, doc) {
                                return jQuery("<small>"+value+"</small>");
                          }}),
                new Cell({name: "Service", width:"40px", field:"service", special: "rendered", 
                          rendering: function(value, idx, doc) {
                            if (value == undefined) 
                                return jQuery("<small>" + value + "</small>");

                            return jQuery("<small>Scrive</small>");
                          }}),
                new Cell({name: "Status", width:"40px", field:"status",  special: "rendered", 
                        rendering: function(value, idx, doc) {
                                return jQuery("<small>"+value+"</small>");
                          }}),
                new Cell({name: "Type", width:"40px", field:"type",  special: "rendered", 
                        rendering: function(value, idx, doc) {
                                return jQuery("<small>"+value+"</small>");
                          }}),
                new Cell({name: "Signatories", width:"120px", field:"signs", special: "rendered",
                          rendering: function(value, idx, doc) {
                            if (value == undefined) 
                                return ;

                            return jQuery("<small>" + value.join('<BR/>') + "</small>");
                          }}),
                new Cell({name: "DAVE", width:"30px", field:"id", special:"rendered",
                          rendering: function(value, idx, doc) {
                            return jQuery("<a href='/dave/document/" + value + "' class='gotodave'>");
                          }})
                ]
        })
    });

    jQuery(function(){
        jQuery("#documents-viewer").append(docTable.view.el)
    });
    </script>
    </div>

####
daveDocument=
$daveBody:noescape()$

<div style="border:10px solid red;padding:10px">
<center> <h1>This option is extreme. Use this only if really needed </h1></center>
<BR/>
<BR/>
<BR/>
$if(closed)$
  <form method="post" action="/adminonly/reseal/$id$">
    <input type="submit" value="Reseal"> </input>
  </form>
  <form method="post" action="/adminonly/replacemainfile/$id$" enctype="multipart/form-data">
    <input type="file" name="file"> </input> <input type="submit" value="Reupload sealed file"></input>
  </form>
$else$
  <form method="post" action="/adminonly/replacemainfile/$id$" enctype="multipart/form-data">
    <input type="file" name="file"> </input> <input type="submit" value="Reupload main file"/>
  </form>
$endif$
<BR/>
</div>
