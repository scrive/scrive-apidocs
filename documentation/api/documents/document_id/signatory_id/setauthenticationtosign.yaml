---
post:

  summary: Set the signatory authentication-to-sign method

  tags:
    - Modify

  description: |
    Set the signatory authentication-to-sign method after the document has been
    started.

    *Side effects of this operation may include adding or modifying fields for the signatory.*

    For example, if the signatory does not have a field for mobile number, then
    setting the authentication method to SMS PIN will necessitate adding a
    mobile number field to the signatory and setting it as obligatory.

    *OAuth Privileges required: `DOC_SEND`*

  parameters:
    - $ref: ../../../../parameters.yaml#/DocumentID
    - $ref: ../../../../parameters.yaml#/SignatoryID
    - name: authentication_type
      in: formData
      type: string
      enum:
        - standard
        - sms_pin
        - se_bankid
      required: true
      description: |
        The type of authentication-to-sign method to set for the signatory.
    - name: authentication_value
      in: formData
      type: string
      required: false
      # default not valid here
      description: |
        Including this parameter will set the value associated with
        `authentication_type` to this value (e.g. mobile number for SMS PIN).

        Setting it to empty string will clear the associated value, if present.

        Excluding it will not affect any signatory properties other than
        necessary side-effects.
        In particular, if a value for the associated field was already set, it
        will not be cleared.
    - $ref: ../../../../parameters.yaml#/ObjectVersion

  responses:
    200:
      $ref: ../../../../responses.yaml#/Document
    409:
      description: |
        Possible error responses:

        * `document_state_error`: The document status should be 'Pending'.
        * `signatory_state_error`: The signatory has already signed.
        * `signatory_state_error`: You canâ€™t mix different e-legitimation
           providers (one for viewing and another for signing) for the same
           signatory.
